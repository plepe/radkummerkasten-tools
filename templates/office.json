{
    "type": "Twig",
    "pre": [
        "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">",
        "<html>",
        "<head>",
        "  <meta http-equiv=\"content-type\" content=\"text/html; charset=utf-8\"/>",
        "  <title></title>",
        "  <meta name=\"generator\" content=\"Radkummerkasten-tools\"/>",
        "  <style type=\"text/css\">",
        "    @page { margin: 0.79in }",
        "    p { margin-bottom: 0.1in; line-height: 120% }",
        "    h1 { margin-bottom: 0.08in; color: #004b67; }",
        "    h2 { margin-bottom: 0.08in; color: #004b67; }",
        "    h3 { color: #004b67; page-break-before: always; }",
        "    h4 { color: #bccf01; }",
        "    td p { margin-bottom: 0in }",
        "    th { text-align: left; vertical-align: top; }",
        "  </style>",
        "</head>",
        "<body lang=\"de-AT\" dir=\"ltr\">",
        "<h1>Dossier RadKummerKasten</h1>",
        "Erstellungsdatum: {{ 'now'|date('j.n.Y') }}"
    ],
    "each": [
        "<h3>#{{ entry.id }} {{ entry.survey|dbApiGet('survey').name}}: {{ entry.address }} ({{ entry.postcode }} {{ entry.city }})</h3>",
        "{% set comment = entry.comments[0] %}",
        "<table>",
        "<tr><th>Datum:</th><td>{{ comment.date|date('j.n.Y G:i') }}</td></tr>",
        "<tr><th>Absender:</th><td>{{ comment.firstname }} {{ comment.lastname }}</td></tr>",
        "<tr><th>Email:</th><td>{{ comment.email }}</td></tr>",
        "<tr><th>PLZ:</th><td>{{ entry.postcode }}</td></tr>",
        "<tr><th>GPS-Koordinaten:</th><td>Breitengrad: {{ entry.lat|number_format(5) }}<br/>Längengrad: {{ entry.lng|number_format(5) }}</td></tr>",
        "<tr><th>Status</th><td>{{ entry.status|dbApiGet('states').name }}</td></tr>",
        "<tr><th>Unterstützungen</th><td>{{ entry.likes }}</td></tr>",
        "<tr><th>Link:</th><td><a href='{{ global.baseUrl }}#marker-{{ entry.id }}'>{{ global.baseUrl }}#marker-{{ entry.id }}</a></td></tr>",
        "</table>",
        "<p>",
        "<h4>Beschreibung</h4>",
        "{% for comment in entry.comments %}",
        "<p>",
        "<i>{{ comment.firstname }} {{ comment.lastname }} schrieb am {{ comment.date }}:</i><br/>",
        "{{ comment.message|nl2br }}",
        "{% endfor %}",
        "</p>",
        "",
        "{% set col=0 %}",
        "<table width=\"100%\" cellpadding=\"4\" cellspacing=\"0\" style=\"page-break-inside: avoid;\">",
        "  <col width=\"128*\">",
        "  <col width=\"128*\">",
        "  <tr><td colspan='2'><h4>Medien</h4></td></tr>",
        "  <tr><td>",
        "    <map style='width: 314px; height: 314px;' scale='300' options='{\"layer\":\"Basemap\",\"zoom\":17}'></map>",
        "  </td><td>",
        "    <map style='width: 314px; height: 314px;' scale='300' options='{\"layer\":\"Basemap Orthophoto\",\"zoom\":19}'></map>",
        "  </td></tr>",
        "{% for comment in entry.comments %}",
        "  {% for attachment in comment.attachments %}",
        "    {% if col == 0 %}",
        "      <tr valign=\"top\">",
        "    {% endif %}",
        "{% set col=col+1 %}",
        "        <td width=\"50%\">",
        "        <img class='attachment' src=\"{{ global.attachmentBaseUrl}}/{{ attachment.file }}\" max-width=\"314\" max-height=\"314\" /><br/>",
        "        Bereitgestellt von {{ comment.firstname }} {{ comment.lastname }} am {{ comment.date }}",
        "        </td>",
        "    {% if col == 2 %}",
        "      </tr>",
        "      {% set col=0 %}",
        "    {% endif %}",
        "  {% endfor %}",
        "{% endfor %}",
        "",
        "{% if col!=0 %}",
        "{% for col in col..1 %}",
        "  <td width=\"50%\">",
        "  </td>",
        "{% endfor %}",
        "</tr>",
        "{% endif %}",
        "",
        "</table>"
    ],
    "post": [
        "</body>",
        "</html>"
    ],
    "extensions": [
        {
            "type": "ImageExport"
        }
    ]
}
